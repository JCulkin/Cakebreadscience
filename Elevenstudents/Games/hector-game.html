<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MIATA NEON DRIVE 2025 | Elevenstudents(best)</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Courier New', monospace;
            background: #000;
            min-height: 100vh;
            color: white;
            overflow: hidden;
        }

        .back-link {
            position: fixed;
            top: 20px;
            left: 20px;
            color: white;
            text-decoration: none;
            opacity: 0.8;
            transition: opacity 0.3s;
            z-index: 1000;
            background: rgba(0, 0, 0, 0.7);
            padding: 10px 15px;
            border-radius: 5px;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .back-link:hover {
            opacity: 1;
        }
    </style>
</head>
<body>
    <a href="../index.html" class="back-link">‚Üê Back to Gallery</a>

    <script>
        /**
         * MIATA REAL-DRIVE 2025: HARDCORE MODE
         * Features: 4 Difficulty levels, Double Fuel Drain in Hardcore, 1% Nitro Boom
         */

        let state = "MENU";
        let difficulty = 1;
        let car;
        let traffic = [];
        let items = [];
        let particles = [];
        let score = 0;
        let fuel = 100;
        let isGameOver = false;
        let gameOverReason = "";
        let worldSpeed = 1;
        let roadY = 0;
        let boostTimer = 0;

        function setup() {
            createCanvas(windowWidth, windowHeight);
            rectMode(CENTER);
            textAlign(CENTER, CENTER);
        }

        function draw() {
            background(5, 5, 12);

            if (state === "MENU") {
                drawMenu();
            } else if (state === "INGAME") {
                runGame();
            }
        }

        // ==========================================
        // MAIN MENU
        // ==========================================
        function drawMenu() {
            drawRealisticRoad();
            roadY += 2;

            drawingContext.shadowBlur = 20;
            drawingContext.shadowColor = color(255, 0, 100);
            fill(255);
            textSize(60);
            textFont('Courier New');
            text("MIATA NEON DRIVE", width / 2, height * 0.20);
            drawingContext.shadowBlur = 0;

            // Buttons
            drawButton(width / 2, height * 0.45, 220, 45, "EASY", () => startGame(1));
            drawButton(width / 2, height * 0.55, 220, 45, "MEDIUM", () => startGame(1.5));
            drawButton(width / 2, height * 0.65, 220, 45, "PRO", () => startGame(2.2));
         
            // HARDCORE BUTTON
            drawButton(width / 2, height * 0.75, 220, 45, "HARDCORE", () => startGame(3.0), color(255, 0, 0));

            fill(0, 255, 255);
            textSize(14);
            text("HARDCORE: 2X FUEL DRAIN + EXTREME SPEED", width / 2, height * 0.85);
        }

        function drawButton(x, y, w, h, label, action, strokeCol = color(255, 0, 100)) {
            let hover = mouseX > x - w / 2 && mouseX < x + w / 2 && mouseY > y - h / 2 && mouseY < y + h / 2;
            if (hover) {
                fill(255, 255, 255, 30);
                stroke(0, 255, 255);
                if (mouseIsPressed) action();
            } else {
                fill(10, 10, 25);
                stroke(strokeCol);
            }
            strokeWeight(2);
            rect(x, y, w, h, 5);
            noStroke();
            fill(255);
            textSize(18);
            text(label, x, y);
        }

        function startGame(diff) {
            state = "INGAME";
            difficulty = diff;
            worldSpeed = diff;
            score = 0;
            fuel = 100;
            boostTimer = 0;
            isGameOver = false;
            traffic = [];
            items = [];
            particles = [];
            car = new RealisticMiata();
        }

        // ==========================================
        // GAME ENGINE
        // ==========================================
        function runGame() {
            if (!isGameOver) {
                let currentSpeed = boostTimer > 0 ? worldSpeed * 2.3 : worldSpeed;
             
                // FUEL LOGIC: Double drain if difficulty is 3.0 (Hardcore)
                let drainMultiplier = (difficulty >= 3.0) ? 2.0 : 1.0;
                let baseDrain = boostTimer > 0 ? 0.15 : 0.06;
                fuel -= baseDrain * drainMultiplier;

                if (fuel <= 0) {
                    fuel = 0;
                    isGameOver = true;
                    gameOverReason = "OUT OF GAS";
                }

                if (boostTimer > 0) {
                    boostTimer--;
                    if (random(1) < 0.01) {
                        triggerExplosion(car.x, car.y);
                        isGameOver = true;
                        gameOverReason = "NITRO EXPLOSION";
                    }
                    if (frameCount % 2 === 0) createNitroSpark(car.x, car.y + 40);
                }
             
                worldSpeed += 0.0003;
                roadY += 15 * currentSpeed;
                drawRealisticRoad();
             
                if (frameCount % floor(30 / worldSpeed) === 0) {
                    let r = random(1);
                    if (r < 0.08) items.push(new GasCan());
                    else if (r < 0.15) items.push(new NitroBottle());
                    else traffic.push(new TrafficCar());
                }
             
                car.update();
                car.show(boostTimer > 0);
                handleEntities(currentSpeed);
                updateParticles();
                drawHUD();
            } else {
                drawGameOver();
            }
        }

        function handleEntities(speed) {
            for (let i = traffic.length - 1; i >= 0; i--) {
                traffic[i].update(speed);
                traffic[i].show();
                if (car.checkCollision(traffic[i])) { triggerExplosion(car.x, car.y); isGameOver = true; gameOverReason = "COLLISION"; }
                if (traffic[i].y > height + 100) { traffic.splice(i, 1); score += floor(difficulty); }
            }
            for (let i = items.length - 1; i >= 0; i--) {
                items[i].update(speed);
                items[i].show();
                if (car.checkCollision(items[i])) {
                    if (items[i].type === "NITRO") boostTimer = 180;
                    if (items[i].type === "GAS") fuel = min(100, fuel + 35);
                    items.splice(i, 1);
                } else if (items[i].y > height + 100) items.splice(i, 1);
            }
        }

        function drawRealisticRoad() {
            const roadW = min(width * 0.75, 550);
            fill(30, 30, 33); noStroke(); rect(width / 2, height / 2, roadW, height);
            stroke(255, 255, 255, 100); strokeWeight(4);
            let gap = 120;
            for (let y = (roadY % gap) - gap; y < height; y += gap) line(width / 2, y, width / 2, y + 60);
        }

        class RealisticMiata {
            constructor() { this.x = width / 2; this.y = height - 150; this.velX = 0; this.friction = 0.88; this.w = 42; this.h = 82; }
            update() {
                this.velX += (mouseX - this.x) * 0.06; this.velX *= this.friction; this.x += this.velX;
                const roadW = min(width * 0.75, 550); this.x = constrain(this.x, (width - roadW) / 2 + 30, (width + roadW) / 2 - 30);
            }
            show(isBoosting) {
                push(); translate(this.x, this.y);
                if (isBoosting) { drawingContext.shadowBlur = 40; drawingContext.shadowColor = color(0, 200, 255); fill(0, 150, 255, 100); rect(0, 20, this.w + 15, this.h + 10, 15); }
                noStroke(); fill(180, 20, 20); rect(0, 0, this.w, this.h, 12);
                fill(10, 10, 20); rect(0, 5, this.w - 8, 38, 5);
                fill(255); rect(-14, -36, 11, 9, 2); rect(14, -36, 11, 9, 2);
                fill(255, 255, 210, isBoosting ? 100 : 40); triangle(-14, -40, -80, -350, 40, -350); triangle(14, -40, 80, -350, -40, -350);
                pop(); drawingContext.shadowBlur = 0;
            }
            checkCollision(other) { return (abs(this.x - other.x) < 35 && abs(this.y - other.y) < 75); }
        }

        class GasCan {
            constructor() { this.type = "GAS"; const roadW = min(width * 0.75, 550); this.x = random((width - roadW) / 2 + 50, (width + roadW) / 2 - 50); this.y = -100; }
            update(s) { this.y += 8 * s; }
            show() { push(); translate(this.x, this.y); fill(220, 50, 0); rect(0, 0, 25, 30, 3); fill(255); rect(8, -12, 6, 10); textAlign(CENTER); textSize(10); text("GAS", 0, 5); pop(); }
        }

        class NitroBottle {
            constructor() { this.type = "NITRO"; const roadW = min(width * 0.75, 550); this.x = random((width - roadW) / 2 + 50, (width + roadW) / 2 - 50); this.y = -100; }
            update(s) { this.y += 8 * s; }
            show() { push(); translate(this.x, this.y); drawingContext.shadowBlur = 15; drawingContext.shadowColor = color(0, 255, 255); fill(0, 180, 255); rect(0, 0, 20, 35, 5); fill(255); textAlign(CENTER); textSize(10); text("NOS", 0, 5); pop(); drawingContext.shadowBlur = 0; }
        }

        class TrafficCar {
            constructor() { const roadW = min(width * 0.75, 550); this.x = random((width - roadW) / 2 + 40, (width + roadW) / 2 - 40); this.y = -100; this.col = color(random(70, 160)); }
            update(s) { this.y += 7 * s; }
            show() { push(); translate(this.x, this.y); fill(this.col); rect(0, 0, 46, 88, 10); drawingContext.shadowBlur = 15; drawingContext.shadowColor = color(255, 0, 0); fill(255, 20, 20); rect(-16, 38, 12, 6, 2); rect(16, 38, 12, 6, 2); pop(); drawingContext.shadowBlur = 0; }
        }

        function createNitroSpark(x, y) { particles.push({ x: x + random(-15, 15), y: y, vx: random(-2, 2), vy: random(2, 5), life: 200, c: color(0, 200, 255) }); }
        function triggerExplosion(x, y) { for (let i = 0; i < 50; i++) particles.push({ x: x, y: y, vx: random(-8, 8), vy: random(-8, 8), life: 255, c: color(255, random(50, 150), 0) }); }
        function updateParticles() { for (let i = particles.length - 1; i >= 0; i--) { let p = particles[i]; p.x += p.vx; p.y += p.vy; p.life -= 6; fill(red(p.c), green(p.c), blue(p.c), p.life); noStroke(); circle(p.x, p.y, p.life / 15); if (p.life <= 0) particles.splice(i, 1); } }

        function drawHUD() {
            fill(50); rect(width - 120, 50, 150, 20, 5);
            let fuelCol = fuel > 25 ? color(0, 255, 100) : color(255, 50, 0);
            fill(fuelCol); rect(width - 120 - (150 - fuel * 1.5) / 2, 50, fuel * 1.5, 20, 5);
            fill(255); textAlign(RIGHT, CENTER); textSize(16); text("FUEL ", width - 200, 50);
            fill(difficulty >= 3 ? color(255, 0, 0) : color(0, 255, 255));
            textAlign(LEFT, CENTER); textSize(22); text("SCORE: " + score, 40, 50);
            if (difficulty >= 3) { fill(255, 0, 0); textSize(14); text("HARDCORE ACTIVE", 40, 75); }
        }

        function drawGameOver() {
            background(0, 210);
            fill(255, 0, 100);
            textSize(50);
            text(gameOverReason, width / 2, height / 2 - 20);
            fill(255);
            textSize(20);
            text("FINAL SCORE: " + score, width / 2, height / 2 + 30);
            text("CLICK TO RETURN TO MENU", width / 2, height / 2 + 70);
        }

        function mousePressed() {
            if (state === "INGAME" && isGameOver) {
                state = "MENU";
            }
        }
    </script>
</body>
</html>