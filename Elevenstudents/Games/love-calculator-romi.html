<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Love Calculator</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.7.0/p5.min.js"></script>
  <style>
    body {
      margin: 0;
      padding: 0;
      overflow: hidden;
      font-family: Arial, sans-serif;
      background: #000;
    }
    input, button {
      font-family: Arial, sans-serif;
    }
  </style>
</head>
<body>
<script>
let nameInput1, nameInput2;
let calcButton, modeButton;

let resultText = "";
let messageText = "";

let lovePercent = 0;
let targetPercent = 0;
let animating = false;

let hearts = [];
let sparkles = [];
let history = [];
let bestMatch = { names: "", percent: 0 };

let mode = "romantic";
let modes = ["romantic", "joke", "chaos"];
let modeIndex = 0;

// ðŸŽ¨ Theme data
let themes = {
  romantic: {
    bg: [255, 120, 170],
    hearts: ["#ff4d6d", "#ff758f", "#ffb3c6"],
    accent: "#ff4d6d"
  },
  joke: {
    bg: [255, 200, 90],
    hearts: ["#ff9f1c", "#ffd166", "#f4d35e"],
    accent: "#ff9f1c"
  },
  chaos: {
    bg: [150, 90, 255],
    hearts: ["#9d4edd", "#c77dff", "#e0aaff"],
    accent: "#9d4edd"
  }
};

function setup() {
  createCanvas(700, 540);
  textAlign(CENTER);
  rectMode(CENTER);

  nameInput1 = createInput("");
  nameInput1.position(250, 160);
  nameInput1.size(200);

  nameInput2 = createInput("");
  nameInput2.position(250, 210);
  nameInput2.size(200);

  calcButton = createButton("ðŸ’– CALCULATE ðŸ’–");
  calcButton.position(265, 260);
  styleButton(calcButton);
  calcButton.mousePressed(startCalculation);

  modeButton = createButton("ðŸ”„ CHANGE MODE");
  modeButton.position(265, 305);
  styleButton(modeButton);
  modeButton.mousePressed(changeMode);
}

function draw() {
  drawBackground();
  drawDecorations();

  fill(255);
  textSize(34);
  text("LOVE CALCULATOR", width / 2, 90);

  textSize(16);
  text("Mode: " + mode.toUpperCase(), width / 2, 125);

  animatePercentage();

  if (animating || targetPercent > 0) {
    textSize(32);
    text(lovePercent + "%", width / 2, 350);

    textSize(20);
    text(resultText, width / 2, 380);
    text(messageText, width / 2, 410);
  }

  drawHearts();
  drawSparkles();
  drawHistory();
}

function startCalculation() {
  let n1 = nameInput1.value().toLowerCase();
  let n2 = nameInput2.value().toLowerCase();
  if (!n1 || !n2) return;

  let seed = 0;
  for (let c of n1 + n2) seed += c.charCodeAt(0);
  randomSeed(mode === "chaos" ? int(random(9999)) : seed);

  targetPercent = int(random(1, 101));
  lovePercent = 0;
  animating = true;

  resultText = n1.toUpperCase() + " â¤ï¸ " + n2.toUpperCase();
  messageText = getMessage(targetPercent);

  history.unshift(resultText + " = " + targetPercent + "%");
  history = history.slice(0, 5);

  if (targetPercent > bestMatch.percent) {
    bestMatch = { names: resultText, percent: targetPercent };
  }

  hearts = [];
  sparkles = [];

  let count = targetPercent >= 80 ? 40 : 18;
  for (let i = 0; i < count; i++) hearts.push(new Heart());
}

function changeMode() {
  modeIndex = (modeIndex + 1) % modes.length;
  mode = modes[modeIndex];

  // Update button colors when mode changes
  styleButton(calcButton);
  styleButton(modeButton);
}

function animatePercentage() {
  if (animating) {
    lovePercent++;
    if (lovePercent >= targetPercent) {
      animating = false;
      if (lovePercent >= 80) {
        for (let i = 0; i < 30; i++) sparkles.push(new Sparkle());
      }
    }
  }
}

function getMessage(p) {
  if (mode === "joke") {
    if (p < 30) return "Yikes ðŸ˜¬";
    if (p < 60) return "Meh ðŸ¤·";
    if (p < 80) return "Actually cute ðŸ˜";
    return "Too perfect ðŸ˜µðŸ’˜";
  }
  if (mode === "chaos") {
    return random(["Pure chaos ðŸ˜ˆ", "Unexplainable ðŸ”®", "Why is this real ðŸ˜µ"]);
  }
  if (p < 20) return "Just friends ðŸ’”";
  if (p < 40) return "Awkward tension ðŸ‘€";
  if (p < 60) return "Cute couple ðŸ’•";
  if (p < 80) return "True love ðŸ’–";
  return "SOULMATES ðŸ”¥ðŸ’˜";
}

// ðŸŽ¨ Visual helpers

function drawBackground() {
  let c = themes[mode].bg;
  background(c[0], c[1], c[2]);
}

function drawDecorations() {
  textSize(18);
  text("ðŸ’—", 225, 175);
  text("ðŸ’—", 225, 225);

  stroke(255, 150);
  line(180, 440, 520, 440);
  noStroke();
  text("ðŸ’–", width / 2, 445);
}

function styleButton(btn) {
  btn.style("border-radius", "20px");
  btn.style("padding", "10px 20px");
  btn.style("border", "none");
  btn.style("background", themes[mode].accent);
  btn.style("color", "white");
  btn.style("font-size", "14px");
  btn.style("cursor", "pointer");
}

function drawHearts() {
  for (let h of hearts) {
    h.update();
    h.display();
  }
}

function drawSparkles() {
  for (let s of sparkles) {
    s.update();
    s.display();
  }
}

function drawHistory() {
  fill(255);
  textSize(13);
  text("Best Match ðŸ’¯", width - 130, 445);
  text(bestMatch.names, width - 130, 462);
  text(bestMatch.percent + "%", width - 130, 478);
}

// ðŸ’— Classes

class Heart {
  constructor() {
    this.x = random(width);
    this.y = random(height, height + 200);
    this.size = random(15, 30);
    this.speed = random(1, 3);
    this.color = random(themes[mode].hearts);
  }
  update() {
    this.y -= this.speed;
    if (this.y < -50) this.y = height + 100;
  }
  display() {
    fill(this.color);
    noStroke();
    push();
    translate(this.x, this.y);
    scale(this.size / 30);
    beginShape();
    vertex(0, -10);
    bezierVertex(-15, -30, -40, -5, 0, 30);
    bezierVertex(40, -5, 15, -30, 0, -10);
    endShape(CLOSE);
    pop();
  }
}

class Sparkle {
  constructor() {
    this.x = random(width);
    this.y = random(height / 2, height);
    this.life = 60;
  }
  update() {
    this.y -= 1;
    this.life--;
  }
  display() {
    fill(255, 255, 255, this.life * 4);
    ellipse(this.x, this.y, 4);
  }
}
</script>
</body>
</html>